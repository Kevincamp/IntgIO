[{"id":"19c9b436.1abdd4","type":"neo4j","z":"bc9bf4a0.4820e","name":"NEW NODE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"CREATE(:Device {\n\tcode  : {code},\n\ttype  : {type},\n\tmodel : {model},\n\tip    : {ip},\n\tonline: {online}\n})\n","x":975,"y":132.5,"wires":[[]]},{"id":"376dfc42.f26fb4","type":"http response","z":"bc9bf4a0.4820e","name":"RESPONSE ADD","x":800.0000457763672,"y":184.36647033691406,"wires":[]},{"id":"d3659e1.05112e","type":"http in","z":"bc9bf4a0.4820e","name":"ADD DEVICE","url":"/ADD/DEVICE","method":"get","swaggerDoc":"","x":186.9915771484375,"y":218.4971466064453,"wires":[["ef3d5262.adafb8"]]},{"id":"ef3d5262.adafb8","type":"function","z":"bc9bf4a0.4820e","name":"Validate ADD","func":"//var header = msg.req.headers;\nvar header = msg.req.query;\nvar code = header.code;\nvar model = header.model;\nvar type = header.type;\nvar type_com = header.typeCom;\nvar ip = header.ip;\nvar puerto = header.puerto;\nvar com ;\nvar online = header.online;\n\nvar map = {};\nif(type_com == \"serial\"){\n    com = header.com;\n    map.com=com;\n}else{\n    com = \"\";\n    map.com=com;\n}\nmap.ip=ip;\nmap.code=code;\nmap.online=online;\nmap.type=type;\nmap.type_com=type_com;\nmap.puerto=puerto;\nmap.model=model;\n\nif(code === undefined || online===undefined || \n   ip === undefined || model === undefined ||\n   type === undefined){\n        msg.payload = \"ERROR\";\n        msg.statusCode = 404;\n}\nelse\n    msg.payload = map;    \nreturn msg;","outputs":"1","noerr":0,"x":327.99725341796875,"y":161.41761779785156,"wires":[["f30b6023.e3b46"]]},{"id":"f30b6023.e3b46","type":"switch","z":"bc9bf4a0.4820e","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":438.9886932373047,"y":217.67897033691406,"wires":[["6c38675d.a9933"],["419c6ba0.9dd414"]]},{"id":"b20fc6c3.3776f8","type":"http in","z":"bc9bf4a0.4820e","name":"DELETE DEVICE","url":"/DELETE/DEVICE","method":"post","swaggerDoc":"","x":198.0370330810547,"y":365.2642059326172,"wires":[["366bdee3.18ab62"]]},{"id":"366bdee3.18ab62","type":"function","z":"bc9bf4a0.4820e","name":"Validate DELETE","func":"var header = msg.req.headers;\nvar code = header.code;\nvar map = {};\nmap.code=code;\nif(code === undefined || code === null){\n    msg.payload = \"ERROR\";\n    msg.statusCode = 404;\n}\nelse\n    msg.payload = map;\nreturn msg;","outputs":"1","noerr":0,"x":334.0370330810547,"y":291.2642059326172,"wires":[["9bcc6bd2.cc8ec"]]},{"id":"21c3fb7c.121244","type":"neo4j","z":"bc9bf4a0.4820e","name":"DELETE NODE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (d:Device {code:{code} })\nOPTIONAL MATCH d-[r]-()\nDELETE d, r","x":597.0370330810547,"y":296.2642059326172,"wires":[["66278dde.5b9734"]]},{"id":"9bcc6bd2.cc8ec","type":"switch","z":"bc9bf4a0.4820e","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":438.0370330810547,"y":361.2642059326172,"wires":[["21c3fb7c.121244"],["6eea10f6.9c886"]]},{"id":"a45b61dd.8fbdf","type":"http response","z":"bc9bf4a0.4820e","name":"RESPONSE DELETE","x":833.0370330810547,"y":362.2642059326172,"wires":[]},{"id":"6eea10f6.9c886","type":"http response","z":"bc9bf4a0.4820e","name":"ERROR DELETE","x":624.0370330810547,"y":393.2642059326172,"wires":[]},{"id":"9d477fe1.9a85e8","type":"http in","z":"bc9bf4a0.4820e","name":"INFO DEVICE","url":"/INFO/DEVICE","method":"get","swaggerDoc":"","x":207.03701782226562,"y":492.2642059326172,"wires":[["b8baf304.1d9428"]]},{"id":"b8baf304.1d9428","type":"function","z":"bc9bf4a0.4820e","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":310.0370178222656,"y":441.2642059326172,"wires":[["ebb361d7.2c7f38"]]},{"id":"29ff6c83.528c4c","type":"neo4j","z":"bc9bf4a0.4820e","name":"INFO NODE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (d:Device {code:{code} })\nRETURN d","x":537.0370178222656,"y":437.2642059326172,"wires":[["3b6215fb.d193a2","4304b5bb.fde5cc"]]},{"id":"ebb361d7.2c7f38","type":"switch","z":"bc9bf4a0.4820e","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":416.0370178222656,"y":489.2642059326172,"wires":[["29ff6c83.528c4c"],["cdcc1cd3.d2ecf"]]},{"id":"b0043546.e42a7","type":"http response","z":"bc9bf4a0.4820e","name":"RESPONSE INFO","x":770.0370178222656,"y":525.2642059326172,"wires":[]},{"id":"cdcc1cd3.d2ecf","type":"http response","z":"bc9bf4a0.4820e","name":"ERROR INFO","x":545.0370178222656,"y":535.2642059326172,"wires":[]},{"id":"3b6215fb.d193a2","type":"function","z":"bc9bf4a0.4820e","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":696.0369873046875,"y":471.26422119140625,"wires":[["b0043546.e42a7"]]},{"id":"419c6ba0.9dd414","type":"http response","z":"bc9bf4a0.4820e","name":"ERROR ADD","x":609.0370330810547,"y":244.2642059326172,"wires":[]},{"id":"66278dde.5b9734","type":"function","z":"bc9bf4a0.4820e","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":819.0370330810547,"y":296.2642059326172,"wires":[["a45b61dd.8fbdf"]]},{"id":"33fcf003.5dc6a8","type":"http in","z":"bc9bf4a0.4820e","name":"MODIFY DEVICE","url":"/MODIFY/DEVICE","method":"get","swaggerDoc":"","x":221.932861328125,"y":746.1531524658203,"wires":[["de706170.99969"]]},{"id":"de706170.99969","type":"function","z":"bc9bf4a0.4820e","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":314.932861328125,"y":695.1531524658203,"wires":[["ee91b517.1b819"]]},{"id":"ee91b517.1b819","type":"switch","z":"bc9bf4a0.4820e","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":424.93284606933594,"y":748.1531524658203,"wires":[["7218ee2a.d21ed"],["109fb0f6.8567e7"]]},{"id":"2bb98942.e2ff16","type":"http response","z":"bc9bf4a0.4820e","name":"RESPONSE INFO","x":863.9328308105469,"y":787.1531524658203,"wires":[]},{"id":"109fb0f6.8567e7","type":"http response","z":"bc9bf4a0.4820e","name":"ERROR INFO","x":582.9328308105469,"y":802.1531524658203,"wires":[]},{"id":"2b76d59.19626aa","type":"function","z":"bc9bf4a0.4820e","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":767.9328308105469,"y":703.1531524658203,"wires":[["2bb98942.e2ff16"]]},{"id":"4304b5bb.fde5cc","type":"debug","z":"bc9bf4a0.4820e","name":"","active":true,"console":"false","complete":"payload","x":867.9915771484375,"y":437.5,"wires":[]},{"id":"6c38675d.a9933","type":"neo4j","z":"bc9bf4a0.4820e","name":"NEW NODE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"create(:Device {code : {code}, model : {model}, type : {type}, type_Comunication : {type_com}, ip : {ip}, puerto : {puerto}, COM:{com}, online: {online}})","x":580.5582275390625,"y":131.06666564941406,"wires":[["376dfc42.f26fb4"]]},{"id":"f9e3481.df63bb8","type":"neo4j","z":"bc9bf4a0.4820e","name":"COMPLETE DEVICE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"match(device {code:{code}})-[:HAVE]->(object)-[:HAVE]->(action) return device,object,action","x":579.9915771484375,"y":872.5,"wires":[["34c56bd3.274154","f11165c0.2cc848"]]},{"id":"f2310d7c.d83fd","type":"http in","z":"bc9bf4a0.4820e","name":"COMPLETE DEVICE","url":"/COMPLETE/DEVICE","method":"get","swaggerDoc":"","x":229.9915771484375,"y":964.5,"wires":[["ac530122.bb9aa8"]]},{"id":"ac530122.bb9aa8","type":"function","z":"bc9bf4a0.4820e","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":329.9915771484375,"y":887.5,"wires":[["7d2823fa.e21c94"]]},{"id":"7d2823fa.e21c94","type":"switch","z":"bc9bf4a0.4820e","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":435.9915771484375,"y":935.5,"wires":[["f9e3481.df63bb8"],["c7ba8108.49d398"]]},{"id":"4669849c.f6bb84","type":"http response","z":"bc9bf4a0.4820e","name":"RESPONSE INFO","x":789.9915771484375,"y":971.5,"wires":[]},{"id":"c7ba8108.49d398","type":"http response","z":"bc9bf4a0.4820e","name":"ERROR INFO","x":564.9915771484375,"y":981.5,"wires":[]},{"id":"34c56bd3.274154","type":"function","z":"bc9bf4a0.4820e","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":715.9915466308594,"y":917.5000152587891,"wires":[["4669849c.f6bb84"]]},{"id":"f11165c0.2cc848","type":"debug","z":"bc9bf4a0.4820e","name":"","active":true,"console":"false","complete":"payload","x":887.9461364746094,"y":883.7357940673828,"wires":[]},{"id":"38ef3bdc.6c3c44","type":"http in","z":"bc9bf4a0.4820e","name":"DEVICE OBJECTS","url":"/DEVICE/OBJECTS","method":"get","swaggerDoc":"","x":234.9915771484375,"y":1169.5,"wires":[["df461249.158f5"]]},{"id":"df461249.158f5","type":"function","z":"bc9bf4a0.4820e","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":364.9915771484375,"y":1114.5,"wires":[["34567ba4.d394dc","8647dd3.227b7a"]]},{"id":"34567ba4.d394dc","type":"switch","z":"bc9bf4a0.4820e","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":470.9915771484375,"y":1162.5,"wires":[[],["2c6486f1.54489a"]]},{"id":"31dee80d.a3c908","type":"http response","z":"bc9bf4a0.4820e","name":"RESPONSE INFO","x":919.9915771484375,"y":1208.5,"wires":[]},{"id":"2c6486f1.54489a","type":"http response","z":"bc9bf4a0.4820e","name":"ERROR INFO","x":599.9915771484375,"y":1208.5,"wires":[]},{"id":"26684c8a.e9b4ac","type":"function","z":"bc9bf4a0.4820e","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":744.9915618896484,"y":1141.5,"wires":[["31dee80d.a3c908"]]},{"id":"71b9f49c.65ba5c","type":"debug","z":"bc9bf4a0.4820e","name":"","active":true,"console":"false","complete":"payload","x":922.9461364746094,"y":1110.7357940673828,"wires":[]},{"id":"8647dd3.227b7a","type":"neo4j","z":"bc9bf4a0.4820e","name":"DEVICE FOR OBJECTS","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (o:Object{code:{code}})-[:HAVE]->(a) MATCH (o:Object{code:{code}})<-[:HAVE]-(d) RETURN d,o,a","x":620.7415771484375,"y":1070.25,"wires":[["71b9f49c.65ba5c","26684c8a.e9b4ac"]]},{"id":"49d01fbe.e9f588","type":"http in","z":"bc9bf4a0.4820e","name":"DEVICE OBJECTS OUT","url":"/DEVICE/OBJECTS/OUT","method":"get","swaggerDoc":"","x":243.7415771484375,"y":1552.25,"wires":[["e8e40581.eae7e"]]},{"id":"e8e40581.eae7e","type":"function","z":"bc9bf4a0.4820e","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":387.7415771484375,"y":1446.25,"wires":[["d1bce5a0.e2dbd8","b77ab404.be164"]]},{"id":"d1bce5a0.e2dbd8","type":"switch","z":"bc9bf4a0.4820e","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":506.7415771484375,"y":1556.25,"wires":[[],["5c7421fc.1cf8e8"]]},{"id":"2c3079f9.4a1ee6","type":"http response","z":"bc9bf4a0.4820e","name":"RESPONSE INFO","x":955.7415771484375,"y":1602.25,"wires":[]},{"id":"5c7421fc.1cf8e8","type":"http response","z":"bc9bf4a0.4820e","name":"ERROR INFO","x":635.7415771484375,"y":1602.25,"wires":[]},{"id":"4d6e6286.c3cacc","type":"function","z":"bc9bf4a0.4820e","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":780.7415618896484,"y":1535.25,"wires":[["2c3079f9.4a1ee6"]]},{"id":"51c425e4.27a3e4","type":"debug","z":"bc9bf4a0.4820e","name":"","active":true,"console":"false","complete":"payload","x":958.6961364746094,"y":1504.4857940673828,"wires":[]},{"id":"b77ab404.be164","type":"neo4j","z":"bc9bf4a0.4820e","name":"PERSONAL OBJECT OUTGOING","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (o:Object{code:{code}})-[:link]->(obs) RETURN obs","x":642.7415771484375,"y":1414.25,"wires":[["51c425e4.27a3e4","4d6e6286.c3cacc"]]},{"id":"55eb213d.4c94c8","type":"neo4j","z":"bc9bf4a0.4820e","name":"PERSONAL OBJECT INCOMMING","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (o:Object{code:{code}})<-[:link]-(obs) RETURN obs","x":682.7415771484375,"y":1703.25,"wires":[["37cfabc8.cdfe6c","8ef84cb8.9a3398"]]},{"id":"160288c8.bbdf0f","type":"http in","z":"bc9bf4a0.4820e","name":"DEVICE OBJECTS IN","url":"/DEVICE/OBJECTS/IN","method":"get","swaggerDoc":"","x":234.7415771484375,"y":1809.25,"wires":[["1281725a.8de98e"]]},{"id":"1281725a.8de98e","type":"function","z":"bc9bf4a0.4820e","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":388.7415771484375,"y":1703.25,"wires":[["cbef280.2fcf058","55eb213d.4c94c8"]]},{"id":"cbef280.2fcf058","type":"switch","z":"bc9bf4a0.4820e","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":507.7415771484375,"y":1813.25,"wires":[[],["8ad2056.8ff6578"]]},{"id":"2357e172.6190d6","type":"http response","z":"bc9bf4a0.4820e","name":"RESPONSE INFO","x":956.7415771484375,"y":1859.25,"wires":[]},{"id":"8ad2056.8ff6578","type":"http response","z":"bc9bf4a0.4820e","name":"ERROR INFO","x":636.7415771484375,"y":1859.25,"wires":[]},{"id":"8ef84cb8.9a3398","type":"function","z":"bc9bf4a0.4820e","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":781.7415618896484,"y":1792.25,"wires":[["2357e172.6190d6"]]},{"id":"37cfabc8.cdfe6c","type":"debug","z":"bc9bf4a0.4820e","name":"","active":true,"console":"false","complete":"payload","x":959.6961364746094,"y":1761.4857940673828,"wires":[]},{"id":"7218ee2a.d21ed","type":"neo4j","z":"bc9bf4a0.4820e","name":"Modify Device","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (d:Device {code:{code} }) SET d.model = {model}, d.type = {type}, d.ip = {ip} RETURN d","x":600.0000076293945,"y":687.5000114440918,"wires":[["2b76d59.19626aa"]]}]