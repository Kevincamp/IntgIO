[{"id":"4d1b39ac.e4ef68","type":"neo4j","z":"f9dd4976.dec25","name":"NEW NODE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"CREATE(:Action {\n\tcode\t: {code},\n\tStatus  : {stat}\n})\n","x":1130,"y":163.93333435058594,"wires":[[]]},{"id":"2c2c444e.170ce4","type":"http in","z":"f9dd4976.dec25","name":"DELETE ACTION","url":"/DELETE/ACTION","method":"post","swaggerDoc":"","x":226.0369873046875,"y":325.6975402832031,"wires":[["4145a214.1cc4ac"]]},{"id":"4145a214.1cc4ac","type":"function","z":"f9dd4976.dec25","name":"Validate DELETE","func":"var header = msg.req.headers;\nvar code = header.code;\nvar map = {};\nmap.code=code;\nif(code === undefined || code === null){\n    msg.payload = \"ERROR\";\n    msg.statusCode = 404;\n}\nelse\n    msg.payload = map;\nreturn msg;","outputs":"1","noerr":0,"x":336.0369873046875,"y":272.6975402832031,"wires":[["660b0c06.4d58a4"]]},{"id":"fb96b9a2.c2037","type":"neo4j","z":"f9dd4976.dec25","name":"DELETE NODE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (a:Action {code:{code} })\nOPTIONAL MATCH a-[r]-()\nDELETE a, r","x":591.0369873046875,"y":274.6975402832031,"wires":[["a7d35e96.a14e8"]]},{"id":"660b0c06.4d58a4","type":"switch","z":"f9dd4976.dec25","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":444.0369873046875,"y":324.6975402832031,"wires":[["fb96b9a2.c2037"],["cdc83e9.52eeac"]]},{"id":"7f30cd95.f4f384","type":"http response","z":"f9dd4976.dec25","name":"RESPONSE DELETE","x":812.0369873046875,"y":323.6975555419922,"wires":[]},{"id":"cdc83e9.52eeac","type":"http response","z":"f9dd4976.dec25","name":"ERROR DELETE","x":614.0369873046875,"y":360.6975555419922,"wires":[]},{"id":"f7af5e62.baaee","type":"http in","z":"f9dd4976.dec25","name":"INFO ACTION","url":"/INFO/ACTION","method":"get","swaggerDoc":"","x":226.0369873046875,"y":459.6975555419922,"wires":[["b02575c2.dd4d4"]]},{"id":"b02575c2.dd4d4","type":"function","z":"f9dd4976.dec25","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":319.0369873046875,"y":408.6975555419922,"wires":[["c7b65b2b.c0a678"]]},{"id":"c7b65b2b.c0a678","type":"switch","z":"f9dd4976.dec25","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":425.0369873046875,"y":456.6975555419922,"wires":[["b45b8caa.b8d9b8"],["d3af5ac9.b56e3"]]},{"id":"14ee4c67.85534c","type":"http response","z":"f9dd4976.dec25","name":"RESPONSE INFO","x":835.0369873046875,"y":493.6975555419922,"wires":[]},{"id":"d3af5ac9.b56e3","type":"http response","z":"f9dd4976.dec25","name":"ERROR INFO","x":592.0369873046875,"y":489.6975555419922,"wires":[]},{"id":"d8ad2cf0.b66a7","type":"function","z":"f9dd4976.dec25","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":714.0369873046875,"y":447.6975555419922,"wires":[["14ee4c67.85534c","9df4b230.1ff1d"]]},{"id":"a7d35e96.a14e8","type":"function","z":"f9dd4976.dec25","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":770.0369873046875,"y":270.6975402832031,"wires":[["7f30cd95.f4f384"]]},{"id":"345df9ef.b33566","type":"function","z":"f9dd4976.dec25","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined ||\n    parameters.stat === null ||\n    parameters.stat === undefined){\n        msg.statusCode = 404;\n        msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":334,"y":534.9333343505859,"wires":[["417ca3c5.3395bc"]]},{"id":"d4929932.0a45d8","type":"neo4j","z":"f9dd4976.dec25","name":"MODIFY NODE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (a:Action { code: {code} })\nSET a.Status = {stat} \nRETURN a","x":591,"y":548.9333343505859,"wires":[["46c43a99.ff433c"]]},{"id":"417ca3c5.3395bc","type":"switch","z":"f9dd4976.dec25","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":433,"y":601.9333343505859,"wires":[["d4929932.0a45d8","3cdfee8e.d92322"],["30740332.9d4c5c"]]},{"id":"d634ee23.28e5c","type":"http response","z":"f9dd4976.dec25","name":"RESPONSE INFO","x":935,"y":614.9333343505859,"wires":[]},{"id":"30740332.9d4c5c","type":"http response","z":"f9dd4976.dec25","name":"ERROR MODIFY","x":610,"y":634.9333343505859,"wires":[]},{"id":"46c43a99.ff433c","type":"function","z":"f9dd4976.dec25","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":915,"y":561.9333343505859,"wires":[["d634ee23.28e5c"]]},{"id":"9f426cc7.3d974","type":"http in","z":"f9dd4976.dec25","name":"CHANGE STATE","url":"/CHANGE/STATE","method":"get","swaggerDoc":"","x":217.0994415283203,"y":605.2969818115234,"wires":[["345df9ef.b33566"]]},{"id":"a3328d6e.462058","type":"debug","z":"f9dd4976.dec25","name":"","active":true,"console":"false","complete":"false","x":848.0369873046875,"y":381.93333435058594,"wires":[]},{"id":"9df4b230.1ff1d","type":"debug","z":"f9dd4976.dec25","name":"","active":true,"console":"false","complete":"false","x":867.0369873046875,"y":429.93333435058594,"wires":[]},{"id":"b45b8caa.b8d9b8","type":"neo4j","z":"f9dd4976.dec25","name":"INFO NODE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (a:Action {code:{code} })\nRETURN a","x":583.0369873046875,"y":401.93333435058594,"wires":[["d8ad2cf0.b66a7","a3328d6e.462058"]]},{"id":"3cdfee8e.d92322","type":"neo4j","z":"f9dd4976.dec25","name":"CASCADE_ACTIONS","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (action {code:{code}})<-[:HAVE]-(object)-[:link]->(objects)-[:HAVE]->(actions) SET actions.Status={stat} RETURN actions","x":638.7869873046875,"y":591.6833343505859,"wires":[[]]},{"id":"fcebd405.21a888","type":"http response","z":"f9dd4976.dec25","name":"RESPONSE ADD","x":823.3333129882812,"y":165,"wires":[]},{"id":"c0cb15e0.957148","type":"http in","z":"f9dd4976.dec25","name":"ADD ACTION","url":"/ADD/ACTION","method":"get","swaggerDoc":"","x":219.3248291015625,"y":167.13067626953125,"wires":[["a5651d28.6049e"]]},{"id":"a5651d28.6049e","type":"function","z":"f9dd4976.dec25","name":"Validate ADD","func":"var header = msg.req.query;\nvar stat = header.stat;\nvar code = header.code;\nvar type = header.type;\nvar descr = header.descr;\n\nvar map = {};\nmap.stat=stat;\nmap.code=code;\nmap.type=type;\nmap.descr=descr;\nmsg.payload = map;\nreturn msg;","outputs":"1","noerr":0,"x":338.33050537109375,"y":119.0511474609375,"wires":[["b79329.ebb12cd8"]]},{"id":"b79329.ebb12cd8","type":"switch","z":"f9dd4976.dec25","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":453.32196044921875,"y":159.3125,"wires":[["7c44704d.85d1f"],["5b19a1f3.fb14"]]},{"id":"5b19a1f3.fb14","type":"http response","z":"f9dd4976.dec25","name":"ERROR ADD","x":619.3703002929688,"y":190.89773559570312,"wires":[]},{"id":"7c44704d.85d1f","type":"neo4j","z":"f9dd4976.dec25","name":"NEW NODE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"CREATE(:Action {code: {code}, Status  : {stat}, Type  : {type}, Description  : {descr}})","x":618.9369506835938,"y":97.7001953125,"wires":[["fcebd405.21a888"]]},{"id":"67e18b87.d7b144","type":"http in","z":"f9dd4976.dec25","name":"INFO ACTIONS BY OBJECT","url":"/INFO/ACTIONSBYOBJECT","method":"get","swaggerDoc":"","x":246.66665649414062,"y":826.6666259765625,"wires":[["9f30b925.008838"]]},{"id":"9f30b925.008838","type":"function","z":"f9dd4976.dec25","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":408.38094329833984,"y":770.1666669845581,"wires":[["e78307a2.7571a8"]]},{"id":"e78307a2.7571a8","type":"switch","z":"f9dd4976.dec25","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":514.3809432983398,"y":818.1666669845581,"wires":[["75590629.361368"],["b310052b.2560f8"]]},{"id":"110881d9.014c4e","type":"http response","z":"f9dd4976.dec25","name":"RESPONSE INFO","x":868.3809432983398,"y":854.1666669845581,"wires":[]},{"id":"b310052b.2560f8","type":"http response","z":"f9dd4976.dec25","name":"ERROR INFO","x":643.3809432983398,"y":864.1666669845581,"wires":[]},{"id":"aa2f120f.4f966","type":"function","z":"f9dd4976.dec25","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":835.3809432983398,"y":765.1666669845581,"wires":[["110881d9.014c4e"]]},{"id":"75590629.361368","type":"neo4j","z":"f9dd4976.dec25","name":"ACTIONS_BY_OBJECT","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (object{code:{code}})-[:HAVE]->(action) RETURN action","x":650.0000076293945,"y":733.3333530426025,"wires":[["aa2f120f.4f966"]]}]