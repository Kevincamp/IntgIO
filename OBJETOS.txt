[{"id":"be24023.f5a64","type":"http response","z":"c5cc5eed.b4481","name":"RESPONSE ADD","x":783.6666259765625,"y":122.53313446044922,"wires":[]},{"id":"55810492.7e65bc","type":"http in","z":"c5cc5eed.b4481","name":"ADD OBJECT","url":"/ADD/OBJECT","method":"get","swaggerDoc":"","x":179.65814208984375,"y":144.66381072998047,"wires":[["1a2832a.92e0dcd"]]},{"id":"1a2832a.92e0dcd","type":"function","z":"c5cc5eed.b4481","name":"Validate ADD","func":"var header = msg.req.query;\nvar code = header.code;\nvar nome = header.name;\nvar type = header.type;\nvar protoco = header.proto;\n\nvar map = {}\nmap.code=code;\nmap.nome=nome;\nmap.type=type;\nmap.protoco=protoco;\nif(code === undefined || nome === undefined || \n    code === null || nome === null ||\n    type === undefined || type === null){\n        msg.statusCode = 404;\n        msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = map;\nreturn msg;","outputs":"1","noerr":0,"x":319.663818359375,"y":91.58428192138672,"wires":[["995fa01d.2d192"]]},{"id":"995fa01d.2d192","type":"switch","z":"c5cc5eed.b4481","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":433.6552734375,"y":149.84563446044922,"wires":[["6a08719d.3172d"],["c8d5990c.0787b8"]]},{"id":"c07f374a.c9e7e8","type":"http in","z":"c5cc5eed.b4481","name":"DELETE OBJECT","url":"/DELETE/OBJECT","method":"post","swaggerDoc":"","x":197.70359802246094,"y":310.43087005615234,"wires":[["9f4f4114.bf561"]]},{"id":"9f4f4114.bf561","type":"function","z":"c5cc5eed.b4481","name":"Validate DELETE","func":"var header = msg.req.headers;\nvar code = header.code;\nvar map = {};\nmap.code=code;\nif(code === undefined || code === null){\n    msg.payload = \"ERROR\";\n    msg.statusCode = 404;\n}\nelse\n    msg.payload = map;\nreturn msg;","outputs":"1","noerr":0,"x":323.70359802246094,"y":236.43087005615234,"wires":[["ef33b868.907f58"]]},{"id":"bab325ca.290e08","type":"neo4j","z":"c5cc5eed.b4481","name":"DELETE NODE","url":"http://neo4j:integradora@200.126.23.138:7474","query":"MATCH (d:Device {code:{code} })\nOPTIONAL MATCH d-[r]-()\nDELETE d, r","x":586.7035980224609,"y":241.43087005615234,"wires":[["d6b7ae25.e4858"]]},{"id":"ef33b868.907f58","type":"switch","z":"c5cc5eed.b4481","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":446.70361328125,"y":290.43087005615234,"wires":[["bab325ca.290e08"],["e37fa8a3.05f158"]]},{"id":"a93d8f5b.951","type":"http response","z":"c5cc5eed.b4481","name":"RESPONSE DELETE","x":822.7035980224609,"y":307.43087005615234,"wires":[]},{"id":"e37fa8a3.05f158","type":"http response","z":"c5cc5eed.b4481","name":"ERROR DELETE","x":595.70361328125,"y":332.4308853149414,"wires":[]},{"id":"c8d5990c.0787b8","type":"http response","z":"c5cc5eed.b4481","name":"ERROR ADD","x":602.70361328125,"y":170.43087005615234,"wires":[]},{"id":"d6b7ae25.e4858","type":"function","z":"c5cc5eed.b4481","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":808.7035980224609,"y":241.43087005615234,"wires":[["a93d8f5b.951"]]},{"id":"7e65d8e9.6e06d8","type":"http in","z":"c5cc5eed.b4481","name":"INFO OBJECT GRAPH","url":"/INFO/OBJECT/GRAPH","method":"get","swaggerDoc":"","x":239.6666259765625,"y":646.5842819213867,"wires":[["20f05337.e9793c"]]},{"id":"20f05337.e9793c","type":"function","z":"c5cc5eed.b4481","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":345.6666259765625,"y":597.5842819213867,"wires":[["2e4d4c1.9bb36b4"]]},{"id":"2e4d4c1.9bb36b4","type":"switch","z":"c5cc5eed.b4481","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":451.6666259765625,"y":645.5842819213867,"wires":[["2b9e5b15.082514"],["69ffdd9c.f2cc74"]]},{"id":"a451a482.a496f8","type":"http response","z":"c5cc5eed.b4481","name":"RESPONSE INFO","x":805.6666259765625,"y":681.5842819213867,"wires":[]},{"id":"69ffdd9c.f2cc74","type":"http response","z":"c5cc5eed.b4481","name":"ERROR INFO","x":580.6666259765625,"y":691.5842819213867,"wires":[]},{"id":"bd2bb96.8ab3848","type":"function","z":"c5cc5eed.b4481","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":772.6666259765625,"y":592.5842819213867,"wires":[["a451a482.a496f8"]]},{"id":"2b9e5b15.082514","type":"neo4j","z":"c5cc5eed.b4481","name":"OBJECT_D_A","url":"http://neo4j:integradora@200.126.23.138:7474","query":"MATCH (object{code:{code}})-[:HAVE]->(action) MATCH (object{code:{code}})<-[:HAVE]-(device) RETURN  device,object,action","x":594.6666259765625,"y":584.5842819213867,"wires":[["bd2bb96.8ab3848"]]},{"id":"6a08719d.3172d","type":"neo4j","z":"c5cc5eed.b4481","name":"NEW NODE","url":"http://neo4j:integradora@200.126.23.138:7474","query":"create (:Object {code : {code}, name : {nome}, protocol : {protoco}, type : {type}})","x":589.2332763671875,"y":79.15094757080078,"wires":[["be24023.f5a64"]]},{"id":"456ac213.b840cc","type":"http in","z":"c5cc5eed.b4481","name":"INFO OBJECT","url":"/INFO/OBJECT","method":"get","swaggerDoc":"","x":193.33328247070312,"y":452.25093841552734,"wires":[["7f2446c3.ef03c8"]]},{"id":"7f2446c3.ef03c8","type":"function","z":"c5cc5eed.b4481","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":286.3332824707031,"y":401.25093841552734,"wires":[["c762a46d.372b08"]]},{"id":"8081b579.1afb48","type":"neo4j","z":"c5cc5eed.b4481","name":"INFO NODE","url":"http://neo4j:integradora@200.126.23.138:7474","query":"MATCH (o:Object {code:{code} })\nRETURN o","x":513.3332824707031,"y":397.25093841552734,"wires":[["605919bd.bcab78"]]},{"id":"c762a46d.372b08","type":"switch","z":"c5cc5eed.b4481","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":392.3332824707031,"y":449.25093841552734,"wires":[["8081b579.1afb48"],["72cfaf3.846995"]]},{"id":"c74898ef.41a068","type":"http response","z":"c5cc5eed.b4481","name":"RESPONSE INFO","x":794.3332824707031,"y":493.2509536743164,"wires":[]},{"id":"72cfaf3.846995","type":"http response","z":"c5cc5eed.b4481","name":"ERROR INFO","x":573.3332824707031,"y":495.2509536743164,"wires":[]},{"id":"605919bd.bcab78","type":"function","z":"c5cc5eed.b4481","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":713.3332824707031,"y":396.25093841552734,"wires":[["c74898ef.41a068"]]},{"id":"b9424dbb.0479c","type":"http in","z":"c5cc5eed.b4481","name":"MODIFY OBJECT","url":"/MODIFY/OBJECT","method":"get","swaggerDoc":"","x":248.33328247070312,"y":820.2509689331055,"wires":[["4970ee1b.1cd2c"]]},{"id":"4970ee1b.1cd2c","type":"function","z":"c5cc5eed.b4481","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":331.3332824707031,"y":769.2509689331055,"wires":[["9607aa0f.4b8108"]]},{"id":"9607aa0f.4b8108","type":"switch","z":"c5cc5eed.b4481","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":441.33326721191406,"y":822.2509689331055,"wires":[["e2354ffc.b05d1"],["c1f086c6.dbf148"]]},{"id":"ba64952d.2a0f78","type":"http response","z":"c5cc5eed.b4481","name":"RESPONSE INFO","x":880.333251953125,"y":861.2509689331055,"wires":[]},{"id":"c1f086c6.dbf148","type":"http response","z":"c5cc5eed.b4481","name":"ERROR INFO","x":599.333251953125,"y":876.2509689331055,"wires":[]},{"id":"a4f0acb8.1b918","type":"function","z":"c5cc5eed.b4481","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":784.333251953125,"y":777.2509689331055,"wires":[["ba64952d.2a0f78"]]},{"id":"e2354ffc.b05d1","type":"neo4j","z":"c5cc5eed.b4481","name":"MODIFY OBJECT","url":"http://neo4j:integradora@200.126.23.138:7474","query":"MATCH (o:Object {code:{code} }) SET o.name = {name}, o.type = {type} RETURN o","x":607.0832824707031,"y":762.7509689331055,"wires":[["a4f0acb8.1b918"]]},{"id":"8cec0660.bf3dd8","type":"http in","z":"c5cc5eed.b4481","name":"INFO OBJECTS BY DEVICE","url":"/INFO/OBJECTSBYDEVICE","method":"get","swaggerDoc":"","x":237.2618408203125,"y":1036.679521560669,"wires":[["7d178e22.5e788"]]},{"id":"7d178e22.5e788","type":"function","z":"c5cc5eed.b4481","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":398.9761276245117,"y":980.1795625686646,"wires":[["cd990e2f.c0ae9"]]},{"id":"cd990e2f.c0ae9","type":"switch","z":"c5cc5eed.b4481","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":504.9761276245117,"y":1028.1795625686646,"wires":[["9a467f0.033928"],["5442107f.19db9"]]},{"id":"e2e4b911.dbef28","type":"http response","z":"c5cc5eed.b4481","name":"RESPONSE INFO","x":858.9761276245117,"y":1064.1795625686646,"wires":[]},{"id":"5442107f.19db9","type":"http response","z":"c5cc5eed.b4481","name":"ERROR INFO","x":633.9761276245117,"y":1074.1795625686646,"wires":[]},{"id":"eb1c5efd.a5fab","type":"function","z":"c5cc5eed.b4481","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":825.9761276245117,"y":975.1795625686646,"wires":[["e2e4b911.dbef28"]]},{"id":"9a467f0.033928","type":"neo4j","z":"c5cc5eed.b4481","name":"OBJECTS_BY_DEVICE","url":"http://neo4j:integradora@200.126.23.138:7474","query":"MATCH (device{code:{code}})-[:HAVE]->(object) RETURN object","x":628.6904449462891,"y":950.9652080535889,"wires":[["eb1c5efd.a5fab"]]},{"id":"76fee188.90e81","type":"http in","z":"c5cc5eed.b4481","name":"INFO OBJECT ACTION","url":"/INFO/OBJECT-ACTION","method":"get","swaggerDoc":"","x":149.5832977294922,"y":1305.4167976379395,"wires":[["5a2c332b.97098c"]]},{"id":"5a2c332b.97098c","type":"function","z":"c5cc5eed.b4481","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":257.58331298828125,"y":1216.916748046875,"wires":[["640b8929.9dac18"]]},{"id":"640b8929.9dac18","type":"switch","z":"c5cc5eed.b4481","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":363.58331298828125,"y":1264.916748046875,"wires":[["59adab07.985ca4"],["ac6c5c82.2a288"]]},{"id":"d353382d.3c61e8","type":"http response","z":"c5cc5eed.b4481","name":"RESPONSE INFO","x":765.5833129882812,"y":1308.916763305664,"wires":[]},{"id":"ac6c5c82.2a288","type":"http response","z":"c5cc5eed.b4481","name":"ERROR INFO","x":544.5833129882812,"y":1310.916763305664,"wires":[]},{"id":"f52cf240.f0ba5","type":"function","z":"c5cc5eed.b4481","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":750.8333129882812,"y":1194.4167976379395,"wires":[["d353382d.3c61e8","9d6b2cb1.ac664"]]},{"id":"11b6e1e0.c2bc6e","type":"http in","z":"c5cc5eed.b4481","name":"INFO DEVICE OBJECT ","url":"/INFO/DEVICE-OBJECT","method":"get","swaggerDoc":"","x":142.08331298828125,"y":1555.416748046875,"wires":[["c36b9c3.322476"]]},{"id":"c36b9c3.322476","type":"function","z":"c5cc5eed.b4481","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":250.0833282470703,"y":1466.9166984558105,"wires":[["ad298052.08da6"]]},{"id":"ad298052.08da6","type":"switch","z":"c5cc5eed.b4481","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":366.083309173584,"y":1546.1667709350586,"wires":[["6a76cfd.5c8873"],["33274a73.0ce376"]]},{"id":"a78df3ee.8c8f3","type":"http response","z":"c5cc5eed.b4481","name":"RESPONSE INFO","x":758.0833282470703,"y":1558.9167137145996,"wires":[]},{"id":"33274a73.0ce376","type":"http response","z":"c5cc5eed.b4481","name":"ERROR INFO","x":537.0833282470703,"y":1560.9167137145996,"wires":[]},{"id":"53314d5.0fdf5b4","type":"function","z":"c5cc5eed.b4481","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":743.3333282470703,"y":1444.416748046875,"wires":[["a78df3ee.8c8f3","845bb373.7a11b"]]},{"id":"845bb373.7a11b","type":"debug","z":"c5cc5eed.b4481","name":"","active":true,"console":"false","complete":"false","x":1047.5000305175781,"y":1486.3333409627278,"wires":[]},{"id":"9d6b2cb1.ac664","type":"debug","z":"c5cc5eed.b4481","name":"","active":true,"console":"false","complete":"false","x":1040.5000305175781,"y":1235.3333409627278,"wires":[]},{"id":"278f30e8.82bd4","type":"http in","z":"c5cc5eed.b4481","name":"COMPLETE OBJECT","url":"/COMPLETE/OBJECT","method":"get","swaggerDoc":"","x":147.6666259765625,"y":1783.666748046875,"wires":[["4180867a.369508"]]},{"id":"4180867a.369508","type":"function","z":"c5cc5eed.b4481","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}else{\n    msg.payload = parameters;\n}\nreturn msg;","outputs":"1","noerr":0,"x":231.6666259765625,"y":1671.666748046875,"wires":[["29558a1d.80bc06"]]},{"id":"29558a1d.80bc06","type":"switch","z":"c5cc5eed.b4481","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":380.6666259765625,"y":1723.666748046875,"wires":[["24abdc86.b14ba4"],["e5409087.73797"]]},{"id":"4e75d4f3.46b08c","type":"http response","z":"c5cc5eed.b4481","name":"RESPONSE INFO","x":734.6666259765625,"y":1759.666748046875,"wires":[]},{"id":"e5409087.73797","type":"http response","z":"c5cc5eed.b4481","name":"ERROR INFO","x":526.6666412353516,"y":1777.666763305664,"wires":[]},{"id":"932fb0f.255715","type":"function","z":"c5cc5eed.b4481","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":660.6665954589844,"y":1705.666763305664,"wires":[["4e75d4f3.46b08c"]]},{"id":"ae3fe2ce.fa378","type":"debug","z":"c5cc5eed.b4481","name":"","active":true,"console":"false","complete":"payload","x":832.6211853027344,"y":1671.9025421142578,"wires":[]},{"id":"bbffaf7.71aa05","type":"http in","z":"c5cc5eed.b4481","name":"DELETE COMPLETE OBJECT","url":"/DELETE/COMPLETE/OBJECT","method":"get","swaggerDoc":"","x":164.66665649414062,"y":1986,"wires":[["46bd4bf9.e7cc34"]]},{"id":"46bd4bf9.e7cc34","type":"function","z":"c5cc5eed.b4481","name":"Validate DELETE","func":"var header = msg.req.query;\nvar code = header.code;\nvar map = {};\nmap.code=code;\nif(code === undefined || code === null){\n    msg.payload = \"ERROR\";\n    msg.statusCode = 404;\n}\nelse\n    msg.payload = map;\nreturn msg;","outputs":"1","noerr":0,"x":292.6666488647461,"y":1871.9997634887695,"wires":[["9910aa7f.191fc8"]]},{"id":"9910aa7f.191fc8","type":"switch","z":"c5cc5eed.b4481","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":422.6666564941406,"y":1947.999755859375,"wires":[["4b0acf23.4626f"],["81037a0a.405818"]]},{"id":"21f2358a.6b13ea","type":"http response","z":"c5cc5eed.b4481","name":"RESPONSE DELETE","x":851.666633605957,"y":1965.9997787475586,"wires":[]},{"id":"81037a0a.405818","type":"http response","z":"c5cc5eed.b4481","name":"ERROR DELETE","x":582.6666488647461,"y":1973.9997634887695,"wires":[]},{"id":"34eff252.15ceae","type":"function","z":"c5cc5eed.b4481","name":"SEARCH","func":"\nreturn msg;","outputs":1,"noerr":0,"x":887.666633605957,"y":1876.9997787475586,"wires":[["21f2358a.6b13ea"]]},{"id":"59adab07.985ca4","type":"neo4j","z":"c5cc5eed.b4481","name":"INFO NODE","url":"http://neo4j:integradora@200.126.23.138:7474","query":"MATCH (o:Object {code:{code} }) OPTIONAL MATCH (o)-[:HAVE]->(a) RETURN a","x":547.6665649414062,"y":1204.6668090820312,"wires":[["f52cf240.f0ba5"]]},{"id":"6a76cfd.5c8873","type":"neo4j","z":"c5cc5eed.b4481","name":"INFO NODE","url":"http://neo4j:integradora@200.126.23.138:7474","query":"MATCH (d:Device {code:{code} }) OPTIONAL MATCH (d)-[:HAVE]->(o) RETURN o","x":539.6665954589844,"y":1458,"wires":[["53314d5.0fdf5b4"]]},{"id":"24abdc86.b14ba4","type":"neo4j","z":"c5cc5eed.b4481","name":"COMPLETE OBJECT","url":"http://neo4j:integradora@200.126.23.138:7474","query":"match(d:Device)-[:HAVE]->(o:Object {code:{code}}) OPTIONAL MATCH (o)-[:HAVE]->(a:Action) return d,o,a","x":520.6665954589844,"y":1640,"wires":[["932fb0f.255715","ae3fe2ce.fa378"]]},{"id":"4b0acf23.4626f","type":"neo4j","z":"c5cc5eed.b4481","name":"DELETE NODE COMPLETE OBJECT","url":"http://neo4j:integradora@200.126.23.138:7474","query":"MATCH (a:Device) MATCH (a)-[r]->(b:Object {code:{code}}) OPTIONAL MATCH (b)-[r1]->(c:Action) OPTIONAL MATCH (b)<-[r2]-(o1:Object) OPTIONAL MATCH (b)-[r3]->(o2:Object) delete r2,r3,r,r1,b,c","x":614.765625,"y":1857.75,"wires":[["34eff252.15ceae"]]}]