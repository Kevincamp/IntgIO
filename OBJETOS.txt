[{"id":"e6f26a2b.75d658","type":"neo4j","z":"df4bb52d.3bbe48","name":"NEW NODE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"CREATE(:Object {\n\tcode  : {code},\n\tname : {nome},\n\ttype : {type}\n})\n","x":764,"y":33.08238220214844,"wires":[[]]},{"id":"de46e5aa.f2ce68","type":"http response","z":"df4bb52d.3bbe48","name":"RESPONSE ADD","x":684,"y":97.9488525390625,"wires":[]},{"id":"a756381b.954948","type":"http in","z":"df4bb52d.3bbe48","name":"ADD OBJECT","url":"/ADD/OBJECT","method":"get","swaggerDoc":"","x":79.99151611328125,"y":120.07952880859375,"wires":[["b19a75db.becb68"]]},{"id":"b19a75db.becb68","type":"function","z":"df4bb52d.3bbe48","name":"Validate ADD","func":"var header = msg.req.query;\nvar code = header.code;\nvar nome = header.name;\nvar type = header.type;\nvar protoco = header.proto;\n\nvar map = {}\nmap.code=code;\nmap.nome=nome;\nmap.type=type;\nmap.protoco=protoco;\nif(code === undefined || nome === undefined || \n    code === null || nome === null ||\n    type === undefined || type === null){\n        msg.statusCode = 404;\n        msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = map;\nreturn msg;","outputs":"1","noerr":0,"x":219.9971923828125,"y":67,"wires":[["100397ff.971c38"]]},{"id":"100397ff.971c38","type":"switch","z":"df4bb52d.3bbe48","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":333.9886474609375,"y":125.2613525390625,"wires":[["4a637461.cd21ec"],["1fb9f3f5.5f18fc"]]},{"id":"be2d76b8.f2dc68","type":"http in","z":"df4bb52d.3bbe48","name":"DELETE OBJECT","url":"/DELETE/OBJECT","method":"post","swaggerDoc":"","x":98.03697204589844,"y":285.8465881347656,"wires":[["4e63b8ba.18a998"]]},{"id":"4e63b8ba.18a998","type":"function","z":"df4bb52d.3bbe48","name":"Validate DELETE","func":"var header = msg.req.headers;\nvar code = header.code;\nvar map = {};\nmap.code=code;\nif(code === undefined || code === null){\n    msg.payload = \"ERROR\";\n    msg.statusCode = 404;\n}\nelse\n    msg.payload = map;\nreturn msg;","outputs":"1","noerr":0,"x":224.03697204589844,"y":211.84658813476562,"wires":[["eec06b71.f99d48"]]},{"id":"7b772d47.d6f3f4","type":"neo4j","z":"df4bb52d.3bbe48","name":"DELETE NODE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (d:Device {code:{code} })\nOPTIONAL MATCH d-[r]-()\nDELETE d, r","x":487.03697204589844,"y":216.84658813476562,"wires":[["8601071d.682f38"]]},{"id":"eec06b71.f99d48","type":"switch","z":"df4bb52d.3bbe48","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":347.0369873046875,"y":265.8465881347656,"wires":[["7b772d47.d6f3f4"],["6c279d1.ead3564"]]},{"id":"df05fca4.cbe","type":"http response","z":"df4bb52d.3bbe48","name":"RESPONSE DELETE","x":723.0369720458984,"y":282.8465881347656,"wires":[]},{"id":"6c279d1.ead3564","type":"http response","z":"df4bb52d.3bbe48","name":"ERROR DELETE","x":496.0369873046875,"y":307.8466033935547,"wires":[]},{"id":"1fb9f3f5.5f18fc","type":"http response","z":"df4bb52d.3bbe48","name":"ERROR ADD","x":503.0369873046875,"y":145.84658813476562,"wires":[]},{"id":"8601071d.682f38","type":"function","z":"df4bb52d.3bbe48","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":709.0369720458984,"y":216.84658813476562,"wires":[["df05fca4.cbe"]]},{"id":"bf77beb1.7a217","type":"http in","z":"df4bb52d.3bbe48","name":"INFO OBJECT GRAPH","url":"/INFO/OBJECT/GRAPH","method":"get","swaggerDoc":"","x":140,"y":622,"wires":[["74456890.571128"]]},{"id":"74456890.571128","type":"function","z":"df4bb52d.3bbe48","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":246,"y":573,"wires":[["88823bc9.0282a8"]]},{"id":"88823bc9.0282a8","type":"switch","z":"df4bb52d.3bbe48","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":352,"y":621,"wires":[["ac3bc0d4.a1b11"],["454b5c8a.0231f4"]]},{"id":"84d4061.0c00df8","type":"http response","z":"df4bb52d.3bbe48","name":"RESPONSE INFO","x":706,"y":657,"wires":[]},{"id":"454b5c8a.0231f4","type":"http response","z":"df4bb52d.3bbe48","name":"ERROR INFO","x":481,"y":667,"wires":[]},{"id":"95ef295c.edd448","type":"function","z":"df4bb52d.3bbe48","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":673,"y":568,"wires":[["84d4061.0c00df8"]]},{"id":"ac3bc0d4.a1b11","type":"neo4j","z":"df4bb52d.3bbe48","name":"OBJECT_D_A","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (object{code:{code}})-[:HAVE]->(action) MATCH (object{code:{code}})<-[:HAVE]-(device) RETURN  device,object,action","x":495,"y":560,"wires":[["95ef295c.edd448"]]},{"id":"4a637461.cd21ec","type":"neo4j","z":"df4bb52d.3bbe48","name":"NEW NODE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"create (:Object {code : {code}, name : {nome}, protocol : {protoco}, type : {type}})","x":489.566650390625,"y":54.56666564941406,"wires":[["de46e5aa.f2ce68"]]},{"id":"7312b3a9.cd3cbc","type":"http in","z":"df4bb52d.3bbe48","name":"INFO OBJECT","url":"/INFO/OBJECT","method":"get","swaggerDoc":"","x":93.66665649414062,"y":427.6666564941406,"wires":[["c5ddd4dc.97c598"]]},{"id":"c5ddd4dc.97c598","type":"function","z":"df4bb52d.3bbe48","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":186.66665649414062,"y":376.6666564941406,"wires":[["e9a8ac72.23a8f"]]},{"id":"b7c324a.fab76d8","type":"neo4j","z":"df4bb52d.3bbe48","name":"INFO NODE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (o:Object {code:{code} })\nRETURN o","x":413.6666564941406,"y":372.6666564941406,"wires":[["dd0ab982.323808"]]},{"id":"e9a8ac72.23a8f","type":"switch","z":"df4bb52d.3bbe48","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":292.6666564941406,"y":424.6666564941406,"wires":[["b7c324a.fab76d8"],["31ab0de6.5ee0a2"]]},{"id":"11e3a697.6a8d89","type":"http response","z":"df4bb52d.3bbe48","name":"RESPONSE INFO","x":694.6666564941406,"y":468.6666717529297,"wires":[]},{"id":"31ab0de6.5ee0a2","type":"http response","z":"df4bb52d.3bbe48","name":"ERROR INFO","x":473.6666564941406,"y":470.6666717529297,"wires":[]},{"id":"dd0ab982.323808","type":"function","z":"df4bb52d.3bbe48","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":613.6666564941406,"y":371.6666564941406,"wires":[["11e3a697.6a8d89"]]},{"id":"5b10fea2.7c9ca","type":"http in","z":"df4bb52d.3bbe48","name":"MODIFY OBJECT","url":"/MODIFY/OBJECT","method":"get","swaggerDoc":"","x":148.66665649414062,"y":795.6666870117188,"wires":[["4904206d.85d05"]]},{"id":"4904206d.85d05","type":"function","z":"df4bb52d.3bbe48","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":231.66665649414062,"y":744.6666870117188,"wires":[["798afedd.e1e22"]]},{"id":"798afedd.e1e22","type":"switch","z":"df4bb52d.3bbe48","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":341.66664123535156,"y":797.6666870117188,"wires":[["3e614e49.0f8692"],["2cc4a6f4.6d7d4a"]]},{"id":"9fa5db0.290fb28","type":"http response","z":"df4bb52d.3bbe48","name":"RESPONSE INFO","x":780.6666259765625,"y":836.6666870117188,"wires":[]},{"id":"2cc4a6f4.6d7d4a","type":"http response","z":"df4bb52d.3bbe48","name":"ERROR INFO","x":499.6666259765625,"y":851.6666870117188,"wires":[]},{"id":"8b64a6d4.8475d8","type":"function","z":"df4bb52d.3bbe48","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":684.6666259765625,"y":752.6666870117188,"wires":[["9fa5db0.290fb28"]]},{"id":"3e614e49.0f8692","type":"neo4j","z":"df4bb52d.3bbe48","name":"MODIFY OBJECT","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (o:Object {code:{code} }) SET o.name = {name}, o.type = {type} RETURN o","x":507.4166564941406,"y":738.1666870117188,"wires":[["8b64a6d4.8475d8"]]},{"id":"1d7d8b37.6cb1a5","type":"http in","z":"df4bb52d.3bbe48","name":"INFO OBJECTS BY DEVICE","url":"/INFO/OBJECTSBYDEVICE","method":"get","swaggerDoc":"","x":137.59521484375,"y":1012.0952396392822,"wires":[["8c830338.98647"]]},{"id":"8c830338.98647","type":"function","z":"df4bb52d.3bbe48","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":299.3095016479492,"y":955.5952806472778,"wires":[["9b732ce.fdac1d"]]},{"id":"9b732ce.fdac1d","type":"switch","z":"df4bb52d.3bbe48","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":405.3095016479492,"y":1003.5952806472778,"wires":[["3c76d90f.2b76f6"],["8177bdbb.3e1a2"]]},{"id":"9e9779cc.8cd7e8","type":"http response","z":"df4bb52d.3bbe48","name":"RESPONSE INFO","x":759.3095016479492,"y":1039.5952806472778,"wires":[]},{"id":"8177bdbb.3e1a2","type":"http response","z":"df4bb52d.3bbe48","name":"ERROR INFO","x":534.3095016479492,"y":1049.5952806472778,"wires":[]},{"id":"38d6fb59.3f5834","type":"function","z":"df4bb52d.3bbe48","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":726.3095016479492,"y":950.5952806472778,"wires":[["9e9779cc.8cd7e8"]]},{"id":"3c76d90f.2b76f6","type":"neo4j","z":"df4bb52d.3bbe48","name":"OBJECTS_BY_DEVICE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (device{code:{code}})-[:HAVE]->(object) RETURN object","x":529.0238189697266,"y":926.3809261322021,"wires":[["38d6fb59.3f5834"]]}]