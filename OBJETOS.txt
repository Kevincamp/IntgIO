[{"id":"72da228b.2eb2ec","type":"tab","label":"objetos"},{"id":"372922b3.ab846e","type":"neo4j","z":"72da228b.2eb2ec","name":"NEW NODE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"CREATE(:Object {\n\tcode  : {code},\n\tname : {nome},\n\ttype : {type}\n})\n","x":764,"y":33.08238220214844,"wires":[[]]},{"id":"3e0348e.1ef6cb8","type":"http response","z":"72da228b.2eb2ec","name":"RESPONSE ADD","x":684,"y":97.9488525390625,"wires":[]},{"id":"6961fec2.7e13e","type":"http in","z":"72da228b.2eb2ec","name":"ADD OBJECT","url":"/ADD/OBJECT","method":"get","swaggerDoc":"","x":79.99151611328125,"y":120.07952880859375,"wires":[["41b83c44.947674"]]},{"id":"41b83c44.947674","type":"function","z":"72da228b.2eb2ec","name":"Validate ADD","func":"var header = msg.req.query;\nvar code = header.code;\nvar nome = header.name;\nvar type = header.type;\nvar protoco = header.proto;\n\nvar map = {}\nmap.code=code;\nmap.nome=nome;\nmap.type=type;\nmap.protoco=protoco;\nif(code === undefined || nome === undefined || \n    code === null || nome === null ||\n    type === undefined || type === null){\n        msg.statusCode = 404;\n        msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = map;\nreturn msg;","outputs":"1","noerr":0,"x":219.9971923828125,"y":67,"wires":[["6a0c0536.1e40dc"]]},{"id":"6a0c0536.1e40dc","type":"switch","z":"72da228b.2eb2ec","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":333.9886474609375,"y":125.2613525390625,"wires":[["93cd5e4b.6bd358"],["57c66b3c.57a2c4"]]},{"id":"152e0fde.b53c5","type":"http in","z":"72da228b.2eb2ec","name":"DELETE OBJECT","url":"/DELETE/OBJECT","method":"post","swaggerDoc":"","x":98.03697204589844,"y":285.8465881347656,"wires":[["4f437a4b.9a7c74"]]},{"id":"4f437a4b.9a7c74","type":"function","z":"72da228b.2eb2ec","name":"Validate DELETE","func":"var header = msg.req.headers;\nvar code = header.code;\nvar map = {};\nmap.code=code;\nif(code === undefined || code === null){\n    msg.payload = \"ERROR\";\n    msg.statusCode = 404;\n}\nelse\n    msg.payload = map;\nreturn msg;","outputs":"1","noerr":0,"x":224.03697204589844,"y":211.84658813476562,"wires":[["f48eb41a.84c5c8"]]},{"id":"56ea5639.b456d8","type":"neo4j","z":"72da228b.2eb2ec","name":"DELETE NODE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (d:Device {code:{code} })\nOPTIONAL MATCH d-[r]-()\nDELETE d, r","x":487.03697204589844,"y":216.84658813476562,"wires":[["3bf47a9a.0aa8e6"]]},{"id":"f48eb41a.84c5c8","type":"switch","z":"72da228b.2eb2ec","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":347.0369873046875,"y":265.8465881347656,"wires":[["56ea5639.b456d8"],["c8f996ee.375d78"]]},{"id":"cd6e5fa4.3491d","type":"http response","z":"72da228b.2eb2ec","name":"RESPONSE DELETE","x":723.0369720458984,"y":282.8465881347656,"wires":[]},{"id":"c8f996ee.375d78","type":"http response","z":"72da228b.2eb2ec","name":"ERROR DELETE","x":496.0369873046875,"y":307.8466033935547,"wires":[]},{"id":"57c66b3c.57a2c4","type":"http response","z":"72da228b.2eb2ec","name":"ERROR ADD","x":503.0369873046875,"y":145.84658813476562,"wires":[]},{"id":"3bf47a9a.0aa8e6","type":"function","z":"72da228b.2eb2ec","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":709.0369720458984,"y":216.84658813476562,"wires":[["cd6e5fa4.3491d"]]},{"id":"9dcb35b7.9d89c","type":"http in","z":"72da228b.2eb2ec","name":"INFO OBJECT GRAPH","url":"/INFO/OBJECT/GRAPH","method":"get","swaggerDoc":"","x":140,"y":622,"wires":[["7c64593c.6c9498"]]},{"id":"7c64593c.6c9498","type":"function","z":"72da228b.2eb2ec","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":246,"y":573,"wires":[["fa8b9e2e.49d2f8"]]},{"id":"fa8b9e2e.49d2f8","type":"switch","z":"72da228b.2eb2ec","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":352,"y":621,"wires":[["d70f44a8.77f2c"],["c61ca1f2.2d2ca8"]]},{"id":"d8ab2580.dd168","type":"http response","z":"72da228b.2eb2ec","name":"RESPONSE INFO","x":706,"y":657,"wires":[]},{"id":"c61ca1f2.2d2ca8","type":"http response","z":"72da228b.2eb2ec","name":"ERROR INFO","x":481,"y":667,"wires":[]},{"id":"a91ac5fd.dd2388","type":"function","z":"72da228b.2eb2ec","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":673,"y":568,"wires":[["d8ab2580.dd168"]]},{"id":"d70f44a8.77f2c","type":"neo4j","z":"72da228b.2eb2ec","name":"OBJECT_D_A","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (object{code:{code}})-[:HAVE]->(action) MATCH (object{code:{code}})<-[:HAVE]-(device) RETURN  device,object,action","x":495,"y":560,"wires":[["a91ac5fd.dd2388"]]},{"id":"93cd5e4b.6bd358","type":"neo4j","z":"72da228b.2eb2ec","name":"NEW NODE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"create (:Object {code : {code}, name : {nome}, protocol : {protoco}, type : {type}})","x":489.566650390625,"y":54.56666564941406,"wires":[["3e0348e.1ef6cb8"]]},{"id":"74b9b969.8f4018","type":"http in","z":"72da228b.2eb2ec","name":"INFO OBJECT","url":"/INFO/OBJECT","method":"get","swaggerDoc":"","x":93.66665649414062,"y":427.6666564941406,"wires":[["6f3f7d9f.6931f4"]]},{"id":"6f3f7d9f.6931f4","type":"function","z":"72da228b.2eb2ec","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":186.66665649414062,"y":376.6666564941406,"wires":[["8640407.a9245c"]]},{"id":"7cb13507.6d0f1c","type":"neo4j","z":"72da228b.2eb2ec","name":"INFO NODE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (o:Object {code:{code} })\nRETURN o","x":413.6666564941406,"y":372.6666564941406,"wires":[["bf106909.5a5808"]]},{"id":"8640407.a9245c","type":"switch","z":"72da228b.2eb2ec","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":292.6666564941406,"y":424.6666564941406,"wires":[["7cb13507.6d0f1c"],["76831c7c.727154"]]},{"id":"3ac4c463.bf6b8c","type":"http response","z":"72da228b.2eb2ec","name":"RESPONSE INFO","x":694.6666564941406,"y":468.6666717529297,"wires":[]},{"id":"76831c7c.727154","type":"http response","z":"72da228b.2eb2ec","name":"ERROR INFO","x":473.6666564941406,"y":470.6666717529297,"wires":[]},{"id":"bf106909.5a5808","type":"function","z":"72da228b.2eb2ec","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":613.6666564941406,"y":371.6666564941406,"wires":[["3ac4c463.bf6b8c"]]},{"id":"593fe3da.f930dc","type":"http in","z":"72da228b.2eb2ec","name":"MODIFY OBJECT","url":"/MODIFY/OBJECT","method":"get","swaggerDoc":"","x":148.66665649414062,"y":795.6666870117188,"wires":[["fff7dad1.17b728"]]},{"id":"fff7dad1.17b728","type":"function","z":"72da228b.2eb2ec","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":231.66665649414062,"y":744.6666870117188,"wires":[["280dbd07.45d2c2"]]},{"id":"280dbd07.45d2c2","type":"switch","z":"72da228b.2eb2ec","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":341.66664123535156,"y":797.6666870117188,"wires":[["3f3bdfe0.a2a5e"],["c2156a91.4960e8"]]},{"id":"d2dedd12.c51f6","type":"http response","z":"72da228b.2eb2ec","name":"RESPONSE INFO","x":780.6666259765625,"y":836.6666870117188,"wires":[]},{"id":"c2156a91.4960e8","type":"http response","z":"72da228b.2eb2ec","name":"ERROR INFO","x":499.6666259765625,"y":851.6666870117188,"wires":[]},{"id":"15b16ecb.5a8a81","type":"function","z":"72da228b.2eb2ec","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":684.6666259765625,"y":752.6666870117188,"wires":[["d2dedd12.c51f6"]]},{"id":"3f3bdfe0.a2a5e","type":"neo4j","z":"72da228b.2eb2ec","name":"MODIFY OBJECT","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (o:Object {code:{code} }) SET o.name = {name}, o.type = {type} RETURN o","x":507.4166564941406,"y":738.1666870117188,"wires":[["15b16ecb.5a8a81"]]},{"id":"727c6463.5e9c6c","type":"http in","z":"72da228b.2eb2ec","name":"INFO OBJECTS BY DEVICE","url":"/INFO/OBJECTSBYDEVICE","method":"get","swaggerDoc":"","x":137.59521484375,"y":1012.0952396392822,"wires":[["5253cc35.d97dd4"]]},{"id":"5253cc35.d97dd4","type":"function","z":"72da228b.2eb2ec","name":"Validate INFO","func":"var parameters = msg.req.query;\nif(parameters.code === null || \n    parameters.code === undefined){\n    msg.statusCode = 404;\n    msg.payload = \"ERROR\";\n}\nelse\n    msg.payload = parameters;\nreturn msg;","outputs":"1","noerr":0,"x":299.3095016479492,"y":955.5952806472778,"wires":[["643f130b.89bddc"]]},{"id":"643f130b.89bddc","type":"switch","z":"72da228b.2eb2ec","name":"DESICION","property":"payload","propertyType":"msg","rules":[{"t":"neq","v":"ERROR","vt":"str"},{"t":"else"}],"checkall":"true","outputs":2,"x":405.3095016479492,"y":1003.5952806472778,"wires":[["9a36f1d5.5fb5e"],["af7b6faf.5d34d"]]},{"id":"ed527ebc.bc8fc","type":"http response","z":"72da228b.2eb2ec","name":"RESPONSE INFO","x":759.3095016479492,"y":1039.5952806472778,"wires":[]},{"id":"af7b6faf.5d34d","type":"http response","z":"72da228b.2eb2ec","name":"ERROR INFO","x":534.3095016479492,"y":1049.5952806472778,"wires":[]},{"id":"34e440e4.86f2d","type":"function","z":"72da228b.2eb2ec","name":"SEARCH","func":"var pay = msg.payload;\nif(pay.data.length === 0){\n    msg.statusCode = 404;\n    msg.payload=\"NOT FOUND\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":726.3095016479492,"y":950.5952806472778,"wires":[["ed527ebc.bc8fc"]]},{"id":"9a36f1d5.5fb5e","type":"neo4j","z":"72da228b.2eb2ec","name":"OBJECTS_BY_DEVICE","url":"http://neo4j:integradora@127.0.0.1:7474","query":"MATCH (device{code:{code}})-[:HAVE]->(object) RETURN object","x":529.0238189697266,"y":926.3809261322021,"wires":[["34e440e4.86f2d"]]}]